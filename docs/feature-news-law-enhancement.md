# 「今日のニュースに関係する法律」機能強化

## 概要

ニュース記事と関連法令の結びつきをより具体的・視覚的にすることで、利用者が法律を身近に感じられるようにする機能強化案。

---

## 現状の実装

- ニュース記事に関連する法令名を抽出（AI生成）
- 法令の概要・背景・メリット/デメリットを表示
- e-Gov法令APIから法令メタデータを取得

---

## 強化ポイント

### 1. 該当条文のハイライト表示

ニュースに直接関係する条文を特定し、ハイライト表示する。

**実装方法:**
- e-Gov法令API `/keyword` エンドポイントでニュースのキーワードを検索
- 該当する条文（`position`）とテキスト（`text`）を取得
- ニュース詳細ページに「関連条文」セクションを追加

**APIレスポンス例:**
```json
{
  "law_title": "道路交通法",
  "position": "第七十一条の四の二第一項",
  "text": "自動車の運転者は、座席ベルトを装着しない者を運転者席以外の乗車装置に乗車させて自動車を運転してはならない。"
}
```

**UI案:**
```
┌─────────────────────────────────────────────┐
│ 📜 関連条文                                  │
├─────────────────────────────────────────────┤
│ 道路交通法 第71条の4の2 第1項               │
│                                             │
│ 「自動車の運転者は、座席ベルトを装着しない  │
│ 者を運転者席以外の乗車装置に乗車させて      │
│ 自動車を運転してはならない。」              │
│                                             │
│ [条文全体を見る →]                          │
└─────────────────────────────────────────────┘
```

---

### 2. 「なぜこの条文が関係するのか」AI解説

条文とニュースの関連性をAIが解説する。

**表示内容:**
- ニュースのどの部分がこの条文に関係するか
- この条文が適用されるとどうなるか（罰則等）
- 一般市民への影響

**UI案:**
```
┌─────────────────────────────────────────────┐
│ 💡 この条文とニュースの関係                  │
├─────────────────────────────────────────────┤
│ このニュースで報じられている事故は、後部座席│
│ のシートベルト未着用が原因の一つとされてい  │
│ ます。道路交通法では運転者に同乗者のベルト  │
│ 着用を確認する義務があり、違反した場合は    │
│ 反則金○○円が科せられます。                │
└─────────────────────────────────────────────┘
```

---

### 3. 条文の階層構造表示

法令の構造（編→章→節→条）を視覚的に表示し、該当条文の位置を明確にする。

**UI案:**
```
道路交通法
├── 第四章 運転者及び使用者の義務
│   ├── 第一節 運転者の義務
│   │   ├── 第71条の4の2 ← 関連条文
│   │   └── ...
```

---

### 4. 複数条文の関連性表示

1つのニュースに複数の条文が関係する場合、それらの関連性を図示する。

**例:** 飲酒運転事故のニュース
- 道路交通法 第65条（酒気帯び運転の禁止）
- 道路交通法 第117条の2（罰則）
- 自動車運転死傷処罰法 第2条（危険運転致死傷）

---

## 技術的な実装案

### データベース拡張

`laws`テーブルに条文情報を追加、または新テーブル作成:

```typescript
// 新テーブル: law_articles
export const lawArticles = sqliteTable("law_articles", {
  id: text("id").primaryKey().$defaultFn(() => nanoid()),
  lawId: text("law_id").notNull().references(() => laws.id),
  articleNum: text("article_num").notNull(),     // 条番号
  articleTitle: text("article_title"),            // 条見出し
  articleText: text("article_text").notNull(),    // 条文本文
  position: text("position"),                     // 位置情報
  createdAt: integer("created_at", { mode: "timestamp" })
    .$defaultFn(() => new Date()),
});

// news_itemsに関連条文を追加
export const newsItems = sqliteTable("news_items", {
  // ... 既存カラム
  relatedArticles: text("related_articles", { mode: "json" })
    .$type<RelatedArticle[]>(),  // [{lawId, articleNum, relevanceNote}]
});
```

### API連携フロー

```
1. ニュース取得時
   ↓
2. AIが関連法令名を抽出（現状の実装）
   ↓
3. 法令APIでキーワード検索 → 該当条文を特定
   ↓
4. 条文とニュースの関連性をAIが解説生成
   ↓
5. DBに保存
```

### 新規コンポーネント

```
components/
├── RelatedArticles.tsx      # 関連条文一覧
├── ArticleHighlight.tsx     # 条文ハイライト表示
├── LawStructureTree.tsx     # 法令構造ツリー
└── ArticleRelevance.tsx     # 条文とニュースの関連解説
```

---

## 期待される効果

1. **理解度向上**: 抽象的な法令名だけでなく、具体的な条文を見せることで理解が深まる
2. **エンゲージメント向上**: 「自分に関係ある」と感じやすくなる
3. **教育的価値**: 法令の読み方・構造を自然に学べる
4. **信頼性向上**: 出典が明確になり、情報の信頼性が高まる

---

## 実装優先度

| 機能 | 優先度 | 工数 |
|------|--------|------|
| 該当条文の表示 | 高 | 中 |
| AI関連性解説 | 高 | 中 |
| 法令構造ツリー | 中 | 大 |
| 複数条文の関連図 | 低 | 大 |

---

## 参考リンク

- [e-Gov 法令API Version2 Swagger UI](https://laws.e-gov.go.jp/api/2/swagger-ui/)
- [e-Gov 法令API Redoc](https://laws.e-gov.go.jp/api/2/redoc/)
